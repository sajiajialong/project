addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
DT::datatable(NYTS_2018_Full[1:20,15:20])
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
NYTS_2018_Selected %>%
filter(Q28 == 2) %>%
select('Q27','Q35','Q36','Q37','Q3') %>%
mutate(Type = ifelse(Q27<=2, "Curious","Not Curious")) %>%
mutate(Q3 = readr::parse_integer(Q3)-1.5) %>%
sample_n(2000) %>%
ggparcoord(columns = 2:5, scale = "globalminmax", splineFactor = 10, alphaLines = 0.5, groupColumn = 6) +
scale_y_discrete(limits=c("Definitely yes","Probably yes","Probably not","Definitely not")) +
labs(x="Questions",y="Responses")
Reasons <- NYTS_2018_Selected %>% filter(is.na(Q33A)) %>% select(matches("Q(1|2|3)$"), contains('Q33'))
Reasons[19:25,5:14]
NYTS_2018_Full %>% select(contains('Q33')) %>%
select(-Q33A) %>% as.matrix() %>% colSums(.,na.rm = T) %>%
tibble(Choice = c("B","C","D","E","F","G","H","I","J"), Count = .) %>%
ggplot() +
geom_col(aes(x=Choice, y=Count))
Reasons %>% count(Q33) %>% filter(n>=10) %>% arrange(desc(n)) %>%
filter(n!=75) %>% mutate(Related_to_B = ifelse(stringr::str_detect(Q33, "B"), 'Yes', 'No')) %>%
mutate(Q33 = forcats::fct_reorder(Q33, n, .desc=FALSE)) %>%
mutate(Count = n) %>%
ggplot() +
geom_col(aes(x = Q33, y=Count, fill=Related_to_B)) +
coord_flip()
library(ggplot2)
library(dplyr)
#library(GGally)
#library(plyr)
#library(vcd)
#library(vcdExtra)
#library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
DT::datatable(NYTS_2018_Full[1:20,15:20])
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
NYTS_2018_Selected %>%
filter(Q28 == 2) %>%
select('Q27','Q35','Q36','Q37','Q3') %>%
mutate(Type = ifelse(Q27<=2, "Curious","Not Curious")) %>%
mutate(Q3 = readr::parse_integer(Q3)-1.5) %>%
sample_n(2000) %>%
ggparcoord(columns = 2:5, scale = "globalminmax", splineFactor = 10, alphaLines = 0.5, groupColumn = 6) +
scale_y_discrete(limits=c("Definitely yes","Probably yes","Probably not","Definitely not")) +
labs(x="Questions",y="Responses")
library(GGally)
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
NYTS_2018_Selected %>%
filter(Q28 == 2) %>%
select('Q27','Q35','Q36','Q37','Q3') %>%
mutate(Type = ifelse(Q27<=2, "Curious","Not Curious")) %>%
mutate(Q3 = readr::parse_integer(Q3)-1.5) %>%
sample_n(2000) %>%
ggparcoord(columns = 2:5, scale = "globalminmax", splineFactor = 10, alphaLines = 0.5, groupColumn = 6) +
scale_y_discrete(limits=c("Definitely yes","Probably yes","Probably not","Definitely not")) +
labs(x="Questions",y="Responses")
Reasons <- NYTS_2018_Selected %>% filter(is.na(Q33A)) %>% select(matches("Q(1|2|3)$"), contains('Q33'))
Reasons[19:25,5:14]
NYTS_2018_Full %>% select(contains('Q33')) %>%
select(-Q33A) %>% as.matrix() %>% colSums(.,na.rm = T) %>%
tibble(Choice = c("B","C","D","E","F","G","H","I","J"), Count = .) %>%
ggplot() +
geom_col(aes(x=Choice, y=Count))
Reasons %>% count(Q33) %>% filter(n>=10) %>% arrange(desc(n)) %>%
filter(n!=75) %>% mutate(Related_to_B = ifelse(stringr::str_detect(Q33, "B"), 'Yes', 'No')) %>%
mutate(Q33 = forcats::fct_reorder(Q33, n, .desc=FALSE)) %>%
mutate(Count = n) %>%
ggplot() +
geom_col(aes(x = Q33, y=Count, fill=Related_to_B)) +
coord_flip()
ggplot()+geom_line(aes(x=2014:2018,y=regular_per[1,],color="e-cigarette"),size=1.5)+
geom_line(aes(x=2014:2018,y=regular_per[2,],color="cigarette"),size=1.5)+
xlab("year")+ylab("percentage of regular smoker")+ggtitle("percentage of regular smoker of e-cigarette/cigarette in each year")
# regular.male_per<- daply(regular[regular$gender==1,],.(key),my.reg.per)
# regular.female_per<- daply(regular[regular$gender==2,],.(key),my.reg.per)
# ratio<- regular.female_per/regular.male_per
ggplot()+ geom_line(aes(x=2014:2018,y=ratio[1,],color="e-cigarette"))+
geom_line(aes(x=2014:2018,y=ratio[2,],color="cigarette"))+
xlab("year")+ylab("ratio:female/male ")+
ggtitle("ratio of female and male regular smokers")
ggplot()+geom_line(aes(x=2014:2018,y=addiction.rate.male,color="male"))+
geom_line(aes(x=2014:2018,y=addiction.rate,color="overall"),size=1)+
geom_line(aes(x=2014:2018,y=addiction.rate.female,color="female"))+
xlab("year")+ylab("addiction rate")+
ggtitle("percentage of those who tried e-cigarette to be addicted to it")
ggplot(data = age_first1)+geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
age_first1 <- readRDS("./output/age_first1.rds")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
age_first1 <- readRDS("./output/age_first1.rds")
ggplot(data = age_first1)+geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
ggplot(data = regular[regular$key=="e"&regular$days>0,])+geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
index<-complete.cases(adv)
adv<- adv[adv$fre>1 & index,]
adv$fre<- as.factor(adv$fre)
adv$source<-as.factor(adv$source)
levels(adv$fre)<- c("Never","Rarely","Sometimes","Most of the time","Always")
platte <- rev(brewer.pal(5, 'RdBu'))
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# adv<- rbind(data.frame(source=rep("internet",dim(internet_2018)[1]),internet_2018),
#             data.frame(source=rep("newspaper",dim(newspaper_2018)[1]), newspaper_2018),
#             data.frame(source=rep("supermarket",dim(supermarket_2018)[1]),supermarket_2018),
#             data.frame(source=rep("TV",dim(TV_2018)[1]),TV_2018))
index<-complete.cases(adv)
adv<- adv[adv$fre>1 & index,]
adv$fre<- as.factor(adv$fre)
adv$source<-as.factor(adv$source)
levels(adv$fre)<- c("Never","Rarely","Sometimes","Most of the time","Always")
platte <- rev(brewer.pal(5, 'RdBu'))
vcd::mosaic(fre ~ source, adv,
direction = c("v", "h"),
gp = gpar(fill = platte),
rot_labels=c(0,90,0,0))
age_first1
ggplot(data = age_first1)+geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
age_first1 %>% mutate(year = factor(year)) %>%
ggplot()+geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
age_first1 %>% mutate(year = factor(year)) %>%
ggplot()+
geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+
ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
regular
adv
ggplot()+
geom_line(aes(x=2014:2018,y=regular_per[1,],color="e-cigarette"),size=1.5)+
geom_line(aes(x=2014:2018,y=regular_per[2,],color="cigarette"),size=1.5)+
xlab("year")+
ylab("percentage of regular smoker")+ggtitle("percentage of regular smoker of e-cigarette/cigarette in each year")
ggplot()+
geom_line(aes(x=2014:2018,y=ratio[1,],color="e-cigarette"))+
geom_line(aes(x=2014:2018,y=ratio[2,],color="cigarette"))+
xlab("year")+ylab("ratio:female/male ")+
ggtitle("ratio of female and male regular smokers")
ggplot()+
geom_line(aes(x=2014:2018,y=addiction.rate.male,color="male"))+
geom_line(aes(x=2014:2018,y=addiction.rate,color="overall"),size=1)+
geom_line(aes(x=2014:2018,y=addiction.rate.female,color="female"))+
xlab("year")+
ylab("addiction rate")+
ggtitle("percentage of those who tried e-cigarette to be addicted to it")
age_first1 %>%
mutate(year = factor(year)) %>%
ggplot()+
geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+
ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
ggplot(data = regular[regular$key=="e"&regular$days>0,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
ggplot(data = regular[regular$key=="e"&regular$days>0,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
index<-complete.cases(adv)
adv<- adv[adv$fre>1 & index,]
adv$fre<- as.factor(adv$fre)
adv$source<-as.factor(adv$source)
levels(adv$fre)<- c("Never","Rarely","Sometimes","Most of the time","Always")
platte <- rev(brewer.pal(5, 'RdBu'))
vcd::mosaic(fre ~ source, adv,
direction = c("v", "h"),
gp = gpar(fill = platte),
rot_labels=c(0,90,0,0))
View(regular)
age_first1 %>%
mutate(year = factor(year)) %>%
ggplot()+
geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+
ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
regular[regular$key=="e"&regular$days>0,]
ggplot(data = regular[regular$key=="e"&regular$days>1,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
ggplot(data = regular[regular$key=="e"&regular$days>2,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
ggplot(data = regular[regular$key=="e"&regular$days>1,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
blogdown::serve_site()
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
blogdown::serve_site()
blogdown::serve_site()
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
DT::datatable(NYTS_2018_Full[1:20,15:20])
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
NYTS_2018_Selected %>%
filter(Q28 == 2) %>%
select('Q27','Q35','Q36','Q37','Q3') %>%
mutate(Type = ifelse(Q27<=2, "Curious","Not Curious")) %>%
mutate(Q3 = readr::parse_integer(Q3)-1.5) %>%
sample_n(2000) %>%
ggparcoord(columns = 2:5, scale = "globalminmax", splineFactor = 10, alphaLines = 0.5, groupColumn = 6) +
scale_y_discrete(limits=c("Definitely yes","Probably yes","Probably not","Definitely not")) +
labs(x="Questions",y="Responses")
Reasons <- NYTS_2018_Selected %>% filter(is.na(Q33A)) %>% select(matches("Q(1|2|3)$"), contains('Q33'))
Reasons[19:25,5:14]
NYTS_2018_Full %>% select(contains('Q33')) %>%
select(-Q33A) %>% as.matrix() %>% colSums(.,na.rm = T) %>%
tibble(Choice = c("B","C","D","E","F","G","H","I","J"), Count = .) %>%
ggplot() +
geom_col(aes(x=Choice, y=Count))
Reasons %>% count(Q33) %>% filter(n>=10) %>% arrange(desc(n)) %>%
filter(n!=75) %>% mutate(Related_to_B = ifelse(stringr::str_detect(Q33, "B"), 'Yes', 'No')) %>%
mutate(Q33 = forcats::fct_reorder(Q33, n, .desc=FALSE)) %>%
mutate(Count = n) %>%
ggplot() +
geom_col(aes(x = Q33, y=Count, fill=Related_to_B)) +
coord_flip()
ggplot()+
geom_line(aes(x=2014:2018,y=regular_per[1,],color="e-cigarette"),size=1.5)+
geom_line(aes(x=2014:2018,y=regular_per[2,],color="cigarette"),size=1.5)+
xlab("year")+
ylab("percentage of regular smoker")+ggtitle("percentage of regular smoker of e-cigarette/cigarette in each year")
ggplot()+
geom_line(aes(x=2014:2018,y=ratio[1,],color="e-cigarette"))+
geom_line(aes(x=2014:2018,y=ratio[2,],color="cigarette"))+
xlab("year")+ylab("ratio:female/male ")+
ggtitle("ratio of female and male regular smokers")
ggplot()+
geom_line(aes(x=2014:2018,y=addiction.rate.male,color="male"))+
geom_line(aes(x=2014:2018,y=addiction.rate,color="overall"),size=1)+
geom_line(aes(x=2014:2018,y=addiction.rate.female,color="female"))+
xlab("year")+
ylab("addiction rate")+
ggtitle("percentage of those who tried e-cigarette to be addicted to it")
age_first1 %>%
mutate(year = factor(year)) %>%
ggplot()+
geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+
ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
ggplot(data = regular[regular$key=="e"&regular$days>1,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
index<-complete.cases(adv)
adv<- adv[adv$fre>1 & index,]
adv$fre<- as.factor(adv$fre)
adv$source<-as.factor(adv$source)
levels(adv$fre)<- c("Never","Rarely","Sometimes","Most of the time","Always")
platte <- rev(brewer.pal(5, 'RdBu'))
vcd::mosaic(fre ~ source, adv,
direction = c("v", "h"),
gp = gpar(fill = platte),
rot_labels=c(0,90,0,0))
blogdown::serve_site()
blogdown::serve_site()
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
DT::datatable(NYTS_2018_Full[1:20,15:20])
ggplot(data = questions_num) +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
NYTS_2018_Selected %>%
filter(Q28 == 2) %>%
select('Q27','Q35','Q36','Q37','Q3') %>%
mutate(Type = ifelse(Q27<=2, "Curious","Not Curious")) %>%
mutate(Q3 = readr::parse_integer(Q3)-1.5) %>%
sample_n(2000) %>%
ggparcoord(columns = 2:5, scale = "globalminmax", splineFactor = 10, alphaLines = 0.5, groupColumn = 6) +
scale_y_discrete(limits=c("Definitely yes","Probably yes","Probably not","Definitely not")) +
labs(x="Questions",y="Responses")
Reasons <- NYTS_2018_Selected %>% filter(is.na(Q33A)) %>% select(matches("Q(1|2|3)$"), contains('Q33'))
Reasons[19:25,5:14]
NYTS_2018_Full %>% select(contains('Q33')) %>%
select(-Q33A) %>% as.matrix() %>% colSums(.,na.rm = T) %>%
tibble(Choice = c("B","C","D","E","F","G","H","I","J"), Count = .) %>%
ggplot() +
geom_col(aes(x=Choice, y=Count))
Reasons %>% count(Q33) %>% filter(n>=10) %>% arrange(desc(n)) %>%
filter(n!=75) %>% mutate(Related_to_B = ifelse(stringr::str_detect(Q33, "B"), 'Yes', 'No')) %>%
mutate(Q33 = forcats::fct_reorder(Q33, n, .desc=FALSE)) %>%
mutate(Count = n) %>%
ggplot() +
geom_col(aes(x = Q33, y=Count, fill=Related_to_B)) +
coord_flip()
ggplot()+
geom_line(aes(x=2014:2018,y=regular_per[1,],color="e-cigarette"),size=1.5)+
geom_line(aes(x=2014:2018,y=regular_per[2,],color="cigarette"),size=1.5)+
xlab("year")+
ylab("percentage of regular smoker")+ggtitle("percentage of regular smoker of e-cigarette/cigarette in each year")
ggplot()+
geom_line(aes(x=2014:2018,y=ratio[1,],color="e-cigarette"))+
geom_line(aes(x=2014:2018,y=ratio[2,],color="cigarette"))+
xlab("year")+ylab("ratio:female/male ")+
ggtitle("ratio of female and male regular smokers")
ggplot()+
geom_line(aes(x=2014:2018,y=addiction.rate.male,color="male"))+
geom_line(aes(x=2014:2018,y=addiction.rate,color="overall"),size=1)+
geom_line(aes(x=2014:2018,y=addiction.rate.female,color="female"))+
xlab("year")+
ylab("addiction rate")+
ggtitle("percentage of those who tried e-cigarette to be addicted to it")
age_first1 %>%
mutate(year = factor(year)) %>%
ggplot()+
geom_boxplot(aes(y=age,x=year,fill=year))+
xlab("year")+
ylab("age of first-time smoking")+
ggtitle("boxplot of age of trying e-cigarette for the first time")
ggplot(data = regular[regular$key=="e"&regular$days>1,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
index<-complete.cases(adv)
adv<- adv[adv$fre>1 & index,]
adv$fre<- as.factor(adv$fre)
adv$source<-as.factor(adv$source)
levels(adv$fre)<- c("Never","Rarely","Sometimes","Most of the time","Always")
platte <- rev(brewer.pal(5, 'RdBu'))
vcd::mosaic(fre ~ source, adv,
direction = c("v", "h"),
gp = gpar(fill = platte),
rot_labels=c(0,90,0,0))
ggplot(data = regular[regular$key=="e"&regular$days>1,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
ggplot(data = regular[regular$key=="e"&regular$days>0,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
ggplot(data = regular)+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
ggplot(data = regular[regular$key=="e"&regular$days>0,])+
geom_boxplot(aes(y=days,x=as.factor(year),fill=as.factor(year)))+
xlab("year")+ylab("days of smoking within one month")+
ggtitle("boxplot of days of smoking within one month")
blogdown::serve_site()
blogdown::serve_site()
questions_num %>% mutate(Year = factor(Year)) %>%
ggplot() +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
library(ggplot2)
library(dplyr)
library(GGally)
library(vcd)
library(vcdExtra)
library(RColorBrewer)
# setwd("/Users/husky/Desktop/5293/project/")
setwd("C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project")
questions_num <- readr::read_csv("./output/Number of Questions.csv") %>%
mutate(Type = factor(Type, levels = c("Indirectly Related", "Directly Related")))
NYTS_2018_Full <- readr::read_csv("./data/2018-NYTS/nyts2018.csv")
NYTS_2018_Selected <- readRDS("./output/NYTS_2018_Selected.rds")
adv <- readRDS("./output/adv.rds")
ratio <- readRDS("./output/ratio.rds")
regular <- readRDS("./output/regular.rds")
age_first1 <- readRDS("./output/age_first1.rds")
regular_per <- readRDS("./output/regular_per.rds")
addiction.rate <- readRDS("./output/addiction.rate.rds")
addiction.rate.male <- readRDS("./output/addiction.rate.male.rds")
addiction.rate.female <- readRDS("./output/addiction.rate.female.rds")
questions_num %>% mutate(Year = factor(Year)) %>%
ggplot() +
geom_col(aes(x=Year, y=Number, fill=Type)) +
scale_fill_manual(values = c("gray75", "gray45"))
shiny::runApp('C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project/doc/e-cigarette')
runApp('C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project/doc/e-cigarette')
runApp('C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project/doc/e-cigarette')
runApp('C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project/doc/e-cigarette')
runApp('C:/Users/sheng/OneDrive/CU Second Semester/Statistical Graphics/Final Project/doc/e-cigarette')
blogdown::serve_site()
